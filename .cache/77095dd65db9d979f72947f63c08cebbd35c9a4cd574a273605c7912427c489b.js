{"source":"webpackJsonp([1],{805:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function n(r,i){try{var o=t[r](i),u=o.value}catch(e){return void a(e)}if(!o.done)return Promise.resolve(u).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(u)}return n(\"next\")})}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(a(96)),o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=n(a(1)),s=(n(a(16)),a(47)),l=n(a(816)),c=a(95),d=n(a(309)),f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={data:[],pagination:{current:1,pageSize:10,total:0},activeFn:{update:a.updateUser.bind(a),delete:a.deleteUser.bind(a),page:a.getUserList.bind(a)},addVisible:!1},a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:\"updateUser\",value:function(){var e=r(i.default.mark(function e(t,a,n){var r,o,u,s,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,e.t0=i.default.keys(this.state.cacheData[a]);case 2:if((e.t1=e.t0()).done){e.next=9;break}if(o=e.t1.value,this.state.cacheData[a][o]==t[o]){e.next=7;break}return r=!0,e.abrupt(\"break\",9);case 7:e.next=2;break;case 9:if(r){e.next=12;break}return notification.warn({message:\"修改失败\",description:\"未作任何修改！\"}),e.abrupt(\"return\");case 12:return t.isUpdate=!0,t.valid=\"name\",e.next=16,(0,c.axiosAjax)([\"user\",\"update\"],t,\"post\");case 16:u=e.sent,s=u.data,l=u.messgage,s?(this.state.cacheData=(0,c.deepClone)(this.state.data||{}),n(s)):notification.warn({message:\"修改失败\",description:l});case 20:case\"end\":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:\"deleteUser\",value:function(){var e=r(i.default.mark(function e(t,a){var n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.axiosAjax)([\"user\",\"delete\"],t,\"post\");case 2:n=e.sent,n.data&&(this.getUserList(),a&&a(),notification.success({message:\"成功\",description:\"删除成功\"}));case 5:case\"end\":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:\"componentWillUpdate\",value:function(){(0,s.getUserFlag)()}},{key:\"componentDidMount\",value:function(){this.getUserList()}},{key:\"getUserList\",value:function(){var e=r(i.default.mark(function e(t){var a,n,r,o,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={currentPage:t&&t.current||this.state.pagination.current,pageSize:t&&t.pageSize||this.state.pagination.pageSize,table:\"user\"},e.next=3,(0,c.axiosAjax)([\"user\",\"list\"],a,\"post\");case 3:n=e.sent,r=n.data,o=n.total,u=(0,c.deepClone)(r||{}),this.setState({data:r,cacheData:u,pagination:{current:a.currentPage,pageSize:a.pageSize,total:o}});case 8:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:\"pageDataChange\",value:function(e){}},{key:\"userProfileSet\",value:function(e){this.setState({addVisible:e})}},{key:\"render\",value:function(){return u.default.createElement(\"div\",{className:\"main-content\"},u.default.createElement(Button,{type:\"primary\",size:\"large\",className:\"editable-add-btn ya-mt10 ya-mb10\",onClick:this.userProfileSet.bind(this,!0)},\"添加员工\"),u.default.createElement(d.default,{flag:\"add\",sucFn:this.getUserList.bind(this),visibleFn:this.userProfileSet.bind(this),visible:this.state.addVisible}),u.default.createElement(l.default,{isCanDel:!0,activeFn:this.state.activeFn,columns:[{title:\"姓名\",dataIndex:\"name\",width:\"20%\",editable:!0},{title:\"电话号码\",dataIndex:\"phone\",width:\"30%\",editable:!0},{title:\"店面地址\",dataIndex:\"address\",width:\"30%\",editable:!0}],pagination:this.state.pagination,data:this.state.data}))}}]),t}();t.default=f},815:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}Object.defineProperty(t,\"__esModule\",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=n(a(1)),u=(n(a(16)),n(a(818)),function(e){function t(){var e,a,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var o=arguments.length,u=Array(o),s=0;s<o;s++)u[s]=arguments[s];return a=n=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.state={value:n.props.value,editable:n.props.editable||!1,onChange:n.props.onChange},i=a,r(n,i)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:\"componentWillReceiveProps\",value:function(e){this.setState({value:e.value}),e.editable!==this.state.editable&&(this.setState({editable:e.editable}),e.editable&&(this.cacheValue=this.state.value)),e.status&&e.status!==this.props.status&&(\"save\"===e.status?this.props.onChange(this.state.value):\"cancel\"===e.status&&(this.setState({value:this.cacheValue}),this.props.onChange(this.cacheValue)))}},{key:\"shouldComponentUpdate\",value:function(e,t){return e.editable!==this.state.editable||t.value!==this.state.value}},{key:\"handleChange\",value:function(e){var t=e.target.value;this.setState({value:t}),this.state.onChange(t)}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.value,n=t.editable;return o.default.createElement(\"div\",null,n?o.default.createElement(\"div\",null,o.default.createElement(Input,{key:this.props.key,value:a,onChange:function(t){return e.handleChange(t)}})):o.default.createElement(\"div\",{className:\"editable-row-text\"},a.toString()||\" \"))}}]),t}());t.default=u},816:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=n(a(1)),o=(n(a(16)),n(a(815))),u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=a.props,r=n.hiddenOpt,o=n.columns,u=n.isCanDel,s=a;return a.editableCol={},o&&o.map(function(e){a.editableCol[e.dataIndex]=e.editable,e.render=function(t,a,n){return s.renderColumns(s.state.data,n,e.dataIndex,t)}}),a.columns=o||[],r||a.columns.push({title:\"操作\",dataIndex:\"operation\",width:\"20%\",render:function(e,t,n){var r=a.state.data[n].editable;return i.default.createElement(\"div\",{className:\"editable-row-operations\"},r?i.default.createElement(\"span\",null,i.default.createElement(Popconfirm,{title:\"是否确定保存?\",onConfirm:function(){return a.editDone(n,\"save\")}},i.default.createElement(\"a\",null,\"保存\")),i.default.createElement(Popconfirm,{title:\"是否确定取消?\",onConfirm:function(){return a.editDone(n,\"cancel\")}},i.default.createElement(\"a\",null,\"取消\"))):i.default.createElement(\"span\",null,i.default.createElement(\"a\",{onClick:function(){return a.edit(n)}},\"修改\"),u?i.default.createElement(Popconfirm,{title:\"是否确定删除?\",onConfirm:function(){return a.delete(n)}},i.default.createElement(\"a\",null,\"删除\")):\"\"))}}),a.state={pagination:a.props.pagination||{},data:a.props.data||[],activeFn:a.props.activeFn||{}},a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),r(t,[{key:\"componentWillReceiveProps\",value:function(e){this.setState({pagination:e.pagination||{},data:e.data||[]})}},{key:\"renderColumns\",value:function(e,t,a,n){var r=this,u=e[t][a],s=e[t].editable&&this.editableCol[a],l=this.editableCol[a]?e[t].status:\"\";return null!=u&&void 0!==u||(u=\"\"),i.default.createElement(o.default,{editable:s||!1,value:u,onChange:function(e){return r.handleChange(a,t,e)},status:l})}},{key:\"handleChange\",value:function(e,t,a){var n=this.state.data;n[t][e]=a,this.setState({data:n})}},{key:\"edit\",value:function(e){var t=this.state.data;t[e].editable=!0,t[e].status=\"\",this.setState({data:t})}},{key:\"delete\",value:function(e){var t=this.state,a=t.data;t.activeFn.delete(a[e])}},{key:\"editDone\",value:function(e,t){var a=this.state,n=a.data,r=a.activeFn,i=this;\"save\"==t?r.update(n[e],e,function(){n[e].editable=!1,n[e].status=\"save\",i.setState({data:n})}):(n[e].editable=!1,n[e].status=\"cancel\",this.setState({data:n}))}},{key:\"showTabelsChange\",value:function(e){this.state.activeFn.page(e)}},{key:\"render\",value:function(){var e=this.state,t=e.data,a=e.pagination,n=t.map(function(e,t){return e.key=t,e}),r=this.columns;return i.default.createElement(\"div\",null,i.default.createElement(Table,{bordered:!0,dataSource:n,columns:r,pagination:a,onChange:this.showTabelsChange.bind(this)}))}}]),t}();t.default=u},817:function(e,t,a){(e.exports=a(53)(void 0)).push([e.i,\".editable-row-text{padding:5px}.editable-row-operations a{margin-right:8px}\",\"\"])},818:function(e,t,a){var n=a(817);\"string\"==typeof n&&(n=[[e.i,n,\"\"]]);a(54)(n,{});n.locals&&(e.exports=n.locals)}});"}